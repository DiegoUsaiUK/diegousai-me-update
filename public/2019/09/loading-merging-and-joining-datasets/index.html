<!DOCTYPE html>
<html lang="en-UK" />
<head>
    <meta http-equiv="Content-Type" content="text/html" charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />

    <title>Loading, Merging and Joining Datasets &middot; </title>

    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="shortcut icon" href="/favicon.ico" />
    <link rel="canonical" href="/2019/09/loading-merging-and-joining-datasets/" />

     <meta name="description" content="This is the minimal coding necessary to assemble various data feeds and sort out the likes of variables naming &amp;amp; new features creation plus some general hou" /> 

     
    
    <meta name="twitter:card" content="summary_large_image"/>
    <meta name="twitter:image" content="/img/stefan-kunze-v8SjXTTI0GA-unsplash.jpg"/>
    
 
    <meta name="twitter:title" content="Loading, Merging and Joining Datasets"/>
    <meta name="twitter:description" content="This is the minimal coding necessary to assemble various data feeds and sort out the likes of variables naming &amp;amp; new features creation plus some general hou"/>
    <meta name="twitter:url" content="/2019/09/loading-merging-and-joining-datasets/" />
    <meta name="twitter:site" content="@"/>

    <meta property="og:site_name" content="" />
    <meta property="og:title" content="Loading, Merging and Joining Datasets &middot; Lifelong Learning" />
    <meta property="og:url" content="/2019/09/loading-merging-and-joining-datasets/" />
    

    <meta property="og:type" content="article" />
    <meta property="og:description" content="This is the minimal coding necessary to assemble various data feeds and sort out the likes of variables naming &amp;amp; new features creation plus some general hou" />

    <meta property="article:published_time" content="2019-09-23T00:00:00Z" />
    <meta property="article:tag" content="Data Cleaning" /><meta property="article:tag" content="Data Mining" /><meta property="article:tag" content="Data Wrangling" /><meta property="article:tag" content="Data Management" />

    <meta property="og:image" content="/img/stefan-kunze-v8SjXTTI0GA-unsplash.jpg"/>


    <meta name="generator" content="Hugo 0.58.3" />

    <!-- Stylesheets -->
    <link rel="stylesheet" type="text/css" href="/built/screen.css" /> 
    <link rel="stylesheet" type="text/css" href="/css/casper-two.css" /> 
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" />
    

     

</head>


<body class="post-template">
  <div class="site-wrapper"> 

<header class="site-header outer">
  <div class="inner">
    <nav class="site-nav">
      <div class="site-nav-left">

        <ul class="nav" role="menu">
        
        
        
            <li class="" role="menuitem">
              <a href="/">Home</a>
            </li>
        
            <li class="" role="menuitem">
              <a href="/post">Articles</a>
            </li>
        
            <li class="" role="menuitem">
              <a href="/tags/">Tags</a>
            </li>
        
            <li class="" role="menuitem">
              <a href="/page/about/">About</a>
            </li>
        
      </ul></div>

      <div class="site-nav-right">
        <div class="social-links">
                    

                    

                    <a class="social-link" href="https://github.com/DiegoUsaiUK" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a>

                    <a class="social-link" href="https://www.linkedin.com/in/diegousaiuk" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 50 512 512"><path d="M150.65,100.682c0,27.992-22.508,50.683-50.273,50.683c-27.765,0-50.273-22.691-50.273-50.683 C50.104,72.691,72.612,50,100.377,50C128.143,50,150.65,72.691,150.65,100.682z M143.294,187.333H58.277V462h85.017V187.333z M279.195,187.333h-81.541V462h81.541c0,0,0-101.877,0-144.181c0-38.624,17.779-61.615,51.807-61.615 c31.268,0,46.289,22.071,46.289,61.615c0,39.545,0,144.181,0,144.181h84.605c0,0,0-100.344,0-173.915 s-41.689-109.131-99.934-109.131s-82.768,45.369-82.768,45.369V187.333z" /></svg></a>

                    <a class="social-link" href="https://medium.com/@diegousaiuk" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 195 195"><path d="M46.5340803,65.2157554 C46.6968378,63.6076572 46.0836,62.018231 44.8828198,60.93592 L32.6512605,46.2010582 L32.6512605,44 L70.6302521,44 L99.9859944,108.380952 L125.794585,44 L162,44 L162,46.2010582 L151.542017,56.2281011 C150.640424,56.9153477 150.193188,58.0448862 150.380019,59.1628454 L150.380019,132.837155 C150.193188,133.955114 150.640424,135.084652 151.542017,135.771899 L161.755369,145.798942 L161.755369,148 L110.38282,148 L110.38282,145.798942 L120.963119,135.527337 C122.002801,134.487948 122.002801,134.182246 122.002801,132.592593 L122.002801,73.0417402 L92.585901,147.755438 L88.6106443,147.755438 L54.3622782,73.0417402 L54.3622782,123.115814 C54.0767278,125.221069 54.7759199,127.3406 56.2581699,128.863022 L70.0186741,145.55438 L70.0186741,147.755438 L31,147.755438 L31,145.55438 L44.7605042,128.863022 C46.2319621,127.338076 46.8903838,125.204485 46.5340803,123.115814 L46.5340803,65.2157554 Z"/></svg></a>
        </div>  
            
      </div>

    </nav>  

  </div>
</header>

<main id="site-main" class="site-main outer" role="main">
  <div class="inner">
    
      <article class="post-full post"> 
    <header class="post-full-header">
        <section class="post-full-meta">
            <time class="post-full-meta-date" datetime="2019-09-23">23 September 2019</time>
                <span class="date-divider">/</span> <a href="/tags/data-cleaning/">#Data Cleaning</a>&nbsp;<a href="/tags/data-mining/">#Data Mining</a>&nbsp;
        </section>
        <h1 class="post-full-title">Loading, Merging and Joining Datasets</h1>
    </header>
    
    <figure class="post-full-image" style="background-image: url(/img/stefan-kunze-v8SjXTTI0GA-unsplash.jpg)">
    </figure>

    <section class="post-full-content">
        <div class="kg-card-markdown">
        


<p>This is the minimal coding necessary to assemble various data feeds and sort out the likes of variables naming &amp; new features creation plus some general housekeeping tasks. It includes general housekeeping tasks like sorting variables names, creating essential features and sorting out variables order</p>
<p>I will continue to add to this code should the need arise for other features to be created.</p>
<p><strong>THE DATASET</strong></p>
<pre class="r"><code>library(tidyverse)
library(lubridate)
library(readr)</code></pre>
<p>The dataset I’m using here accompanies a Redbooks publication called <a href="https://www.redbooks.ibm.com/abstracts/sg248133.html?Open"><em>Building 360-Degree Information Applications</em></a> which is available as a free PDF download. Also available as a free download are the excel files in the <a href="ftp://www.redbooks.ibm.com/redbooks/SG248133"><strong>Additional Material</strong></a> section to follow along with the exercises in the book.</p>
<p>The data covers <em>3 &amp; 1/2 years</em> worth of sales <code>orders</code> for the <strong>Sample Outdoors Company</strong>, a fictitious B2B outdoor equipment retailer enterprise. The data comes with details about the <code>products</code> they sell as well as their customers (which are <code>retailers</code> in their case). The data is a subset of the <em>GSDB database</em>, a realistic and feature-rich database created by IBM® to support demos for their products.</p>
<p><strong>LOAD, MERGE AND JOIN</strong></p>
<p>I will start with sales transactions as they are distributed across almost 900 separate excel files.</p>
<p>First, I load and merge them at once from a single folder and bind them by row into an <code>orders</code> file.</p>
<pre class="r"><code>orders &lt;- list.files(path = &quot;order-details&quot;,
           pattern = &quot;*.csv&quot;, 
           full.names = T) %&gt;% 
   map_df(~readr::read_csv(.))</code></pre>
<p><strong>NOTE</strong> that all files have the same format with each single variable sitting on the same column in each file</p>
<pre class="r"><code>orders %&gt;% glimpse()
## Observations: 446,023
## Variables: 45
## $ order_date            &lt;dttm&gt; 2004-01-12, 2004-01-12, 2004-01-12, 200...
## $ sales_staff_code      &lt;dbl&gt; 10798, 10798, 10406, 10406, 10406, 10406...
## $ order_method_it       &lt;chr&gt; &quot;Reparto vendite&quot;, &quot;Reparto vendite&quot;, &quot;F...
## $ order_method_en       &lt;chr&gt; &quot;Sales visit&quot;, &quot;Sales visit&quot;, &quot;Fax&quot;, &quot;Fa...
## $ order_method_nl       &lt;chr&gt; &quot;Vertegenwoordiger&quot;, &quot;Vertegenwoordiger&quot;...
## $ order_detail_code     &lt;dbl&gt; 1000001, 1000002, 1000013, 1000014, 1000...
## $ return_count          &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, ...
## $ order_method_no       &lt;chr&gt; &quot;Salgsbesøk&quot;, &quot;Salgsbesøk&quot;, &quot;Faks&quot;, &quot;Fak...
## $ order_method_el       &lt;chr&gt; &quot;&lt;U+0395&gt;p&lt;U+03AF&gt;s&lt;U+03BA&gt;e&lt;U+03C8&gt;&lt;U+03B7&gt; p&lt;U+03C9&gt;&lt;U+03BB&gt;&lt;U+03B7&gt;t&lt;U+03AE&gt;&quot;, &quot;&lt;U+0395&gt;p&lt;U+03AF&gt;s&lt;U+03BA&gt;e&lt;U+03C8&gt;&lt;U+03B7&gt; p&lt;U+03C9&gt;&lt;U+03BB&gt;&lt;U+03B7&gt;t&lt;U+03AE&gt;&quot;, &quot;F...
## $ unit_cost             &lt;dbl&gt; 15.62, 49.69, 80.00, 23.53, 176.47, 39.0...
## $ order_method_tc       &lt;chr&gt; &quot;&lt;U+696D&gt;&lt;U+52D9&gt;&lt;U+62DC&gt;&lt;U+8A2A&gt;&quot;, &quot;&lt;U+696D&gt;&lt;U+52D9&gt;&lt;U+62DC&gt;&lt;U+8A2A&gt;&quot;, &quot;&lt;U+50B3&gt;&lt;U+771F&gt;&quot;, &quot;&lt;U+50B3&gt;&lt;U+771F&gt;&quot;, &quot;&lt;U+50B3&gt;&lt;U+771F&gt;&quot;, &quot;&lt;U+50B3&gt;&lt;U+771F&gt;&quot;, ...
## $ order_detail_code_2   &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, ...
## $ retailer_name         &lt;chr&gt; &quot;Kavanagh Sports&quot;, &quot;Kavanagh Sports&quot;, &quot;A...
## $ retailer_name_mb      &lt;chr&gt; &quot;Kavanagh Sports&quot;, &quot;Kavanagh Sports&quot;, &quot;A...
## $ order_method_cs       &lt;chr&gt; &quot;Návšteva prodejce&quot;, &quot;Návšteva prodejce&quot;...
## $ order_method_hu       &lt;chr&gt; &quot;Kiszállásos eladás&quot;, &quot;Kiszállásos eladá...
## $ order_method_ms       &lt;chr&gt; &quot;Lawatan jualan&quot;, &quot;Lawatan jualan&quot;, &quot;Fak...
## $ order_method_th       &lt;chr&gt; &quot;&lt;U+0E40&gt;&lt;U+0E22&gt;&lt;U+0E35&gt;&lt;U+0E48&gt;&lt;U+0E22&gt;&lt;U+0E21&gt;&lt;U+0E25&gt;&lt;U+0E39&gt;&lt;U+0E01&gt;&lt;U+0E04&gt;&lt;U+0E49&gt;&lt;U+0E32&gt;&quot;, &quot;&lt;U+0E40&gt;&lt;U+0E22&gt;&lt;U+0E35&gt;&lt;U+0E48&gt;&lt;U+0E22&gt;&lt;U+0E21&gt;&lt;U+0E25&gt;&lt;U+0E39&gt;&lt;U+0E01&gt;&lt;U+0E04&gt;&lt;U+0E49&gt;&lt;U+0E32&gt;&quot;, &quot;&lt;U+0E41&gt;&lt;U+0E1F&gt;&lt;U+0E01&gt;&lt;U+0E0B&gt;&lt;U+0E4C&gt;&quot;,...
## $ quantity              &lt;dbl&gt; 256, 92, 162, 172, 74, 90, 422, 3252, 11...
## $ order_number_2        &lt;dbl&gt; 100001, 100001, 100002, 100002, 100002, ...
## $ sales_branch_code     &lt;dbl&gt; 21, 21, 30, 30, 30, 30, 30, 30, 30, 30, ...
## $ promotion_code        &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0...
## $ order_method_id       &lt;chr&gt; &quot;Kunjungan penjualan&quot;, &quot;Kunjungan penjua...
## $ order_number          &lt;dbl&gt; 100001, 100001, 100002, 100002, 100002, ...
## $ order_method_sc       &lt;chr&gt; &quot;&lt;U+9500&gt;&lt;U+552E&gt;&lt;U+9762&gt;&lt;U+8BBF&gt;&quot;, &quot;&lt;U+9500&gt;&lt;U+552E&gt;&lt;U+9762&gt;&lt;U+8BBF&gt;&quot;, &quot;&lt;U+4F20&gt;&lt;U+771F&gt;&quot;, &quot;&lt;U+4F20&gt;&lt;U+771F&gt;&quot;, &quot;&lt;U+4F20&gt;&lt;U+771F&gt;&quot;, &quot;&lt;U+4F20&gt;&lt;U+771F&gt;&quot;, ...
## $ order_method_fi       &lt;chr&gt; &quot;Myyntikäynti&quot;, &quot;Myyntikäynti&quot;, &quot;Faksi&quot;,...
## $ order_method_ru       &lt;chr&gt; &quot;&lt;U+0422&gt;&lt;U+043E&gt;&lt;U+0440&gt;&lt;U+0433&gt;. &lt;U+0430&gt;&lt;U+0433&gt;&lt;U+0435&gt;&lt;U+043D&gt;&lt;U+0442&gt;&quot;, &quot;&lt;U+0422&gt;&lt;U+043E&gt;&lt;U+0440&gt;&lt;U+0433&gt;. &lt;U+0430&gt;&lt;U+0433&gt;&lt;U+0435&gt;&lt;U+043D&gt;&lt;U+0442&gt;&quot;, &quot;&lt;U+0424&gt;&lt;U+0430&gt;&lt;U+043A&gt;&lt;U+0441&gt;&quot;, &quot;&lt;U+0424&gt;...
## $ retailer_site_code    &lt;dbl&gt; 20530, 20530, 20895, 20895, 20895, 20895...
## $ unit_sale_price       &lt;dbl&gt; 33.69, 102.30, 111.31, 38.90, 334.43, 75...
## $ order_method_da       &lt;chr&gt; &quot;Sælgerbesøg&quot;, &quot;Sælgerbesøg&quot;, &quot;Fax&quot;, &quot;Fa...
## $ order_method_pl       &lt;chr&gt; &quot;Wizyta&quot;, &quot;Wizyta&quot;, &quot;Faks&quot;, &quot;Faks&quot;, &quot;Fak...
## $ order_method_de       &lt;chr&gt; &quot;Verkaufsbesuch&quot;, &quot;Verkaufsbesuch&quot;, &quot;Fax...
## $ order_method_ko       &lt;chr&gt; &quot;&lt;U+BC29&gt;&lt;U+BB38&gt;&lt;U+D310&gt;&lt;U+B9E4&gt;&quot;, &quot;&lt;U+BC29&gt;&lt;U+BB38&gt;&lt;U+D310&gt;&lt;U+B9E4&gt;&quot;, &quot;&lt;U+D329&gt;&lt;U+C2A4&gt;&quot;, &quot;&lt;U+D329&gt;&lt;U+C2A4&gt;&quot;, &quot;&lt;U+D329&gt;&lt;U+C2A4&gt;&quot;, &quot;&lt;U+D329&gt;&lt;U+C2A4&gt;&quot;, ...
## $ ship_date             &lt;dttm&gt; 2004-01-19, 2004-02-17, 2004-01-19, 200...
## $ order_method_sv       &lt;chr&gt; &quot;Säljbesök&quot;, &quot;Säljbesök&quot;, &quot;Fax&quot;, &quot;Fax&quot;, ...
## $ order_method_fr       &lt;chr&gt; &quot;Visite d&#39;un représentant&quot;, &quot;Visite d&#39;un...
## $ order_method_code_2   &lt;dbl&gt; 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1...
## $ unit_price            &lt;dbl&gt; 35.09, 110.00, 119.69, 40.52, 359.60, 81...
## $ order_method_pt       &lt;chr&gt; &quot;Visita vendas&quot;, &quot;Visita vendas&quot;, &quot;Fax&quot;,...
## $ order_method_es       &lt;chr&gt; &quot;Visita de ventas&quot;, &quot;Visita de ventas&quot;, ...
## $ order_close_date      &lt;dttm&gt; 2004-02-17, 2004-02-17, 2004-01-19, 200...
## $ retailer_contact_code &lt;dbl&gt; 3549, 3549, 3915, 3915, 3915, 3915, 3915...
## $ order_method_code     &lt;dbl&gt; 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1...
## $ order_method_ja       &lt;chr&gt; &quot;&lt;U+5E97&gt;&lt;U+982D&gt;&quot;, &quot;&lt;U+5E97&gt;&lt;U+982D&gt;&quot;, &quot;&lt;U+30D5&gt;&lt;U+30A1&gt;&lt;U+30C3&gt;&lt;U+30AF&gt;&lt;U+30B9&gt;&quot;, &quot;&lt;U+30D5&gt;&lt;U+30A1&gt;&lt;U+30C3&gt;&lt;U+30AF&gt;&lt;U+30B9&gt;&quot;, &quot;&lt;U+30D5&gt;&lt;U+30A1&gt;&lt;U+30C3&gt;&lt;U+30AF&gt;&lt;U+30B9&gt;&quot;, &quot;...
## $ product_number        &lt;dbl&gt; 41110, 69110, 75110, 76110, 85110, 65110...</code></pre>
<p>A bit of a clean up is required as there are 45 <code>orders</code> variables but most of them are not necessary. For instance, <code>order_method</code> is available in many languages but I only need the one in English.</p>
<p>I start by removing all <code>order_method</code> other than English.</p>
<pre class="r"><code>orders &lt;- 
   orders %&gt;% 
   rename(
      order_method = order_method_en,
      retailer = retailer_name
      )  %&gt;% 
   select(
      -contains(&#39;order_method_&#39;)
      ) </code></pre>
<pre class="r"><code>orders %&gt;% glimpse()
## Observations: 446,023
## Variables: 21
## $ order_date            &lt;dttm&gt; 2004-01-12, 2004-01-12, 2004-01-12, 200...
## $ sales_staff_code      &lt;dbl&gt; 10798, 10798, 10406, 10406, 10406, 10406...
## $ order_method          &lt;chr&gt; &quot;Sales visit&quot;, &quot;Sales visit&quot;, &quot;Fax&quot;, &quot;Fa...
## $ order_detail_code     &lt;dbl&gt; 1000001, 1000002, 1000013, 1000014, 1000...
## $ return_count          &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, ...
## $ unit_cost             &lt;dbl&gt; 15.62, 49.69, 80.00, 23.53, 176.47, 39.0...
## $ order_detail_code_2   &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, ...
## $ retailer              &lt;chr&gt; &quot;Kavanagh Sports&quot;, &quot;Kavanagh Sports&quot;, &quot;A...
## $ retailer_name_mb      &lt;chr&gt; &quot;Kavanagh Sports&quot;, &quot;Kavanagh Sports&quot;, &quot;A...
## $ quantity              &lt;dbl&gt; 256, 92, 162, 172, 74, 90, 422, 3252, 11...
## $ order_number_2        &lt;dbl&gt; 100001, 100001, 100002, 100002, 100002, ...
## $ sales_branch_code     &lt;dbl&gt; 21, 21, 30, 30, 30, 30, 30, 30, 30, 30, ...
## $ promotion_code        &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0...
## $ order_number          &lt;dbl&gt; 100001, 100001, 100002, 100002, 100002, ...
## $ retailer_site_code    &lt;dbl&gt; 20530, 20530, 20895, 20895, 20895, 20895...
## $ unit_sale_price       &lt;dbl&gt; 33.69, 102.30, 111.31, 38.90, 334.43, 75...
## $ ship_date             &lt;dttm&gt; 2004-01-19, 2004-02-17, 2004-01-19, 200...
## $ unit_price            &lt;dbl&gt; 35.09, 110.00, 119.69, 40.52, 359.60, 81...
## $ order_close_date      &lt;dttm&gt; 2004-02-17, 2004-02-17, 2004-01-19, 200...
## $ retailer_contact_code &lt;dbl&gt; 3549, 3549, 3915, 3915, 3915, 3915, 3915...
## $ product_number        &lt;dbl&gt; 41110, 69110, 75110, 76110, 85110, 65110...</code></pre>
<p>Then I load the <code>products</code> file, which, as it says on the tin, contains the products information</p>
<pre class="r"><code># load products file
products &lt;- 
   read_csv(&#39;products.csv&#39;)</code></pre>
<pre class="r"><code>products %&gt;% glimpse()
## Observations: 274
## Variables: 20
## $ product_description &lt;chr&gt; &quot;The Venue has a fun and fashionable overs...
## $ base_product_number &lt;dbl&gt; 125, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12...
## $ product_line        &lt;chr&gt; &quot;Personal Accessories&quot;, &quot;Camping Equipment...
## $ production_cost     &lt;dbl&gt; 0.00, 4.00, 9.22, 15.93, 5.00, 34.97, 85.1...
## $ product_image       &lt;chr&gt; &quot;P65PA3WT10.jpg&quot;, &quot;P01CE1CG1.jpg&quot;, &quot;P02CE1...
## $ product_type        &lt;chr&gt; &quot;Watches&quot;, &quot;Cooking Gear&quot;, &quot;Cooking Gear&quot;,...
## $ color               &lt;chr&gt; &quot;Red&quot;, &quot;Clear&quot;, &quot;Brown&quot;, &quot;Unspecified&quot;, &quot;S...
## $ gross_margin        &lt;dbl&gt; 0.00, 0.33, 0.23, 0.28, 0.28, 0.30, 0.28, ...
## $ product_line_code   &lt;dbl&gt; 993, 991, 991, 991, 991, 991, 991, 991, 99...
## $ product_name        &lt;chr&gt; &quot;Venue&quot;, &quot;TrailChef Water Bag&quot;, &quot;TrailChef...
## $ introduction_date   &lt;dttm&gt; 2005-04-01, 1995-02-15, 1995-02-15, 1995-...
## $ title               &lt;chr&gt; &quot;Venue&quot;, &quot;TrailChef Water Bag&quot;, &quot;TrailChef...
## $ product_type_code   &lt;dbl&gt; 960, 951, 951, 951, 951, 951, 951, 951, 95...
## $ product_size        &lt;chr&gt; &quot;One-size&quot;, &quot;10 liters&quot;, &quot;2 liters&quot;, &quot;15-p...
## $ brand               &lt;chr&gt; &quot;Relax&quot;, &quot;TrailChef&quot;, &quot;TrailChef&quot;, &quot;TrailC...
## $ discontinued_date   &lt;dttm&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N...
## $ product_brand_code  &lt;dbl&gt; 756, 701, 701, 701, 701, 701, 701, 701, 70...
## $ product_size_code   &lt;dbl&gt; 853, 808, 807, 825, 804, 823, 824, 845, 84...
## $ product_color_code  &lt;dbl&gt; 922, 908, 906, 924, 923, 923, 923, 923, 91...
## $ product_number      &lt;dbl&gt; 125150, 1110, 2110, 3110, 4110, 5110, 6110...</code></pre>
<p>Finally, the <code>retailers</code> file</p>
<pre class="r"><code># load retailer info
retailers &lt;- 
   read_csv(&#39;retailers.csv&#39;)</code></pre>
<pre class="r"><code>retailers %&gt;% glimpse()
## Observations: 847
## Variables: 13
## $ REGION_CODE        &lt;dbl&gt; 710, 710, 710, 710, 710, 710, 710, 710, 710...
## $ REGION_EN          &lt;chr&gt; &quot;Americas&quot;, &quot;Americas&quot;, &quot;Americas&quot;, &quot;Americ...
## $ COUNTRY_CODE       &lt;dbl&gt; 1004, 1004, 1004, 1004, 1004, 1004, 1004, 1...
## $ COUNTRY_KEY        &lt;dbl&gt; 90002, 90002, 90002, 90002, 90002, 90002, 9...
## $ COUNTRY_EN         &lt;chr&gt; &quot;Canada&quot;, &quot;Canada&quot;, &quot;Canada&quot;, &quot;Canada&quot;, &quot;Ca...
## $ RETAILER_KEY       &lt;dbl&gt; 6789, 6789, 6789, 6790, 6790, 6790, 6790, 6...
## $ RETAILER_CODE      &lt;dbl&gt; 1189, 1189, 1189, 1190, 1190, 1190, 1190, 1...
## $ RETAILER_NAME      &lt;chr&gt; &quot;Rock Steady&quot;, &quot;Rock Steady&quot;, &quot;Rock Steady&quot;...
## $ RETAILER_SITE_KEY  &lt;dbl&gt; 5001, 5002, 5003, 5004, 5005, 5006, 5007, 5...
## $ RETAILER_SITE_CODE &lt;dbl&gt; 20001, 20002, 20003, 20004, 20005, 20006, 2...
## $ RTL_CITY           &lt;chr&gt; &quot;Winnipeg&quot;, &quot;Montr\xe9al&quot;, &quot;Fredericton&quot;, &quot;...
## $ RETAILER_TYPE_CODE &lt;dbl&gt; 6, 6, 6, 8, 8, 8, 8, 3, 2, 2, 2, 2, 2, 1, 7...
## $ RETAILER_TYPE_EN   &lt;chr&gt; &quot;Outdoors Shop&quot;, &quot;Outdoors Shop&quot;, &quot;Outdoors...</code></pre>
<p>As R is case sensitive, I’m setting <code>retailers</code> column names to lower-case</p>
<pre class="r"><code>retailers &lt;- 
   retailers %&gt;% 
   rename_all(tolower) </code></pre>
<p>Now I can joining <code>orders</code>, <code>products</code> and <code>retailers</code> info into one data frame</p>
<pre class="r"><code>df &lt;- 
   orders %&gt;% 
   left_join(products, by = (&#39;product_number&#39;)) %&gt;% 
   left_join(retailers, by = (&#39;retailer_site_code&#39;)) </code></pre>
<p>Creating essential features &amp; some housekeeping tasks</p>
<p>One long piece of code to sort all in one go.</p>
<p>I’ve added comments to each block to explain what it’s doing.</p>
<pre class="r"><code>orders_tbl   &lt;- 
   
    # create revenue, total product cost and gross profit
   df %&gt;%
      mutate(
         revenue       = quantity * unit_price,
         tot_prod_cost = quantity * unit_cost,
         gross_profit  = revenue - tot_prod_cost
      ) %&gt;% 
      
      # replacing NAs in the return_count variable
   replace_na(list(return_count = 0)) %&gt;% 
      
    # Shorten product line names for readablility and ease of use in charts and code
    
   mutate(
      prod_line = case_when(
         product_line == &#39;Camping Equipment&#39; ~ &#39;Camping Eqpt&#39;,
         product_line == &#39;Golf Equipment&#39; ~ &#39;Golf Eqpt&#39;,
         product_line == &#39;Mountaineering Equipment&#39; ~ &#39;Mountain Eqpt&#39;,
         product_line == &#39;Personal Accessories&#39; ~ &#39;Personal Acces&#39;,
         product_line == &#39;Outdoor Protection&#39; ~ &#39;Outdoor Prot&#39;,
         TRUE ~ product_line
      ),
      
      prod_line_2 = case_when(
         product_line == &#39;Camping Equipment&#39; ~ &#39;Camping Eqpt&#39;,
         product_line == &#39;Golf Equipment&#39; ~ &#39;Golf Eqpt&#39;,
         product_line == &#39;Mountaineering Equipment&#39; ~ &#39;Mountain Eqpt&#39;,
         product_line == &#39;Personal Accessories&#39; ~ &#39;Personal Acces&#39;,
         product_line == &#39;Outdoor Protection&#39; ~ &#39;Personal Acces&#39;,
         TRUE ~ product_line
      ),
      
      # create alternative regional group
      region2 = case_when(
         country_en %in% c(&#39;United Kingdom&#39;, &#39;France&#39;, &#39;Spain&#39;,  
                        &#39;Netherlands&#39;,&#39;Belgium&#39;,&#39;Switzerland&#39;) ~ &#39;West Europe&#39;,
         country_en %in% c(&#39;Germany&#39;, &#39;Italy&#39;, &#39;Finland&#39;,  
                        &#39;Austria&#39;,&#39;Sweden&#39;,&#39;Denmark&#39;) ~ &#39;East Europe&#39;,
         TRUE ~ region_en
      )
   ) %&gt;% 
   
   # create financial years
   mutate(
      ord_date = ymd(order_date),
      fin_year = case_when(
         between(ord_date, ymd(&quot;2004-07-01&quot;), ymd(&#39;2005-06-30&#39;)) ~ &#39;FY_04_05&#39;,
         between(ord_date, ymd(&quot;2005-07-01&quot;), ymd(&#39;2006-06-30&#39;)) ~ &#39;FY_05_06&#39;,
         between(ord_date, ymd(&quot;2006-07-01&quot;), ymd(&#39;2007-06-30&#39;)) ~ &#39;FY_06_07&#39;,
         TRUE ~ &#39;other&#39;
      ),
      
      # create all quarters
      quarter_all = case_when(
         between(ord_date, ymd(&quot;2004-01-01&quot;), ymd(&#39;2004-03-31&#39;)) ~ &#39;04_Q1&#39;,
         between(ord_date, ymd(&quot;2004-04-01&quot;), ymd(&#39;2004-06-30&#39;)) ~ &#39;04_Q2&#39;,
         between(ord_date, ymd(&quot;2004-07-01&quot;), ymd(&#39;2004-09-30&#39;)) ~ &#39;04_Q3&#39;,
         between(ord_date, ymd(&quot;2004-10-01&quot;), ymd(&#39;2004-12-31&#39;)) ~ &#39;04_Q4&#39;,
         between(ord_date, ymd(&quot;2005-01-01&quot;), ymd(&#39;2005-03-31&#39;)) ~ &#39;05_Q1&#39;,
         between(ord_date, ymd(&quot;2005-04-01&quot;), ymd(&#39;2005-06-30&#39;)) ~ &#39;05_Q2&#39;,
         between(ord_date, ymd(&quot;2005-07-01&quot;), ymd(&#39;2005-09-30&#39;)) ~ &#39;05_Q3&#39;,
         between(ord_date, ymd(&quot;2005-10-01&quot;), ymd(&#39;2005-12-31&#39;)) ~ &#39;05_Q4&#39;,
         between(ord_date, ymd(&quot;2006-01-01&quot;), ymd(&#39;2006-03-31&#39;)) ~ &#39;06_Q1&#39;,
         between(ord_date, ymd(&quot;2006-04-01&quot;), ymd(&#39;2006-06-30&#39;)) ~ &#39;06_Q2&#39;,
         between(ord_date, ymd(&quot;2006-07-01&quot;), ymd(&#39;2006-09-30&#39;)) ~ &#39;06_Q3&#39;,
         between(ord_date, ymd(&quot;2006-10-01&quot;), ymd(&#39;2006-12-31&#39;)) ~ &#39;06_Q4&#39;,
         between(ord_date, ymd(&quot;2007-01-01&quot;), ymd(&#39;2007-03-31&#39;)) ~ &#39;07_Q1&#39;,
         between(ord_date, ymd(&quot;2007-04-01&quot;), ymd(&#39;2007-06-30&#39;)) ~ &#39;07_Q2&#39;,
         between(ord_date, ymd(&quot;2007-07-01&quot;), ymd(&#39;2007-09-30&#39;)) ~ &#39;07_Q3&#39;,
         TRUE ~ &#39;other&#39;
      ),
      
      # create selected quarters
      quarter_sel = case_when(
         between(ord_date, ymd(&quot;2004-07-01&quot;), ymd(&#39;2004-09-30&#39;)) ~ &#39;04_Q3&#39;,
         between(ord_date, ymd(&quot;2004-10-01&quot;), ymd(&#39;2004-12-31&#39;)) ~ &#39;04_Q4&#39;,
         between(ord_date, ymd(&quot;2005-01-01&quot;), ymd(&#39;2005-03-31&#39;)) ~ &#39;05_Q1&#39;,
         between(ord_date, ymd(&quot;2005-04-01&quot;), ymd(&#39;2005-06-30&#39;)) ~ &#39;05_Q2&#39;,
         between(ord_date, ymd(&quot;2005-07-01&quot;), ymd(&#39;2005-09-30&#39;)) ~ &#39;05_Q3&#39;,
         between(ord_date, ymd(&quot;2005-10-01&quot;), ymd(&#39;2005-12-31&#39;)) ~ &#39;05_Q4&#39;,
         between(ord_date, ymd(&quot;2006-01-01&quot;), ymd(&#39;2006-03-31&#39;)) ~ &#39;06_Q1&#39;,
         between(ord_date, ymd(&quot;2006-04-01&quot;), ymd(&#39;2006-06-30&#39;)) ~ &#39;06_Q2&#39;,
         between(ord_date, ymd(&quot;2006-07-01&quot;), ymd(&#39;2006-09-30&#39;)) ~ &#39;06_Q3&#39;,
         between(ord_date, ymd(&quot;2006-10-01&quot;), ymd(&#39;2006-12-31&#39;)) ~ &#39;06_Q4&#39;,
         between(ord_date, ymd(&quot;2007-01-01&quot;), ymd(&#39;2007-03-31&#39;)) ~ &#39;07_Q1&#39;,
         between(ord_date, ymd(&quot;2007-04-01&quot;), ymd(&#39;2007-06-30&#39;)) ~ &#39;07_Q2&#39;,
         TRUE ~ &#39;other&#39;
      )
      
      
   ) %&gt;% 
   
   # reorder columns and rename a few
      select(
      order_number,
      order_date,
      order_close_date,
      order_ship_date = ship_date,
      fin_year,
      quarter_all,
      quarter_sel,
      order_method,
      retailer,
      retailer_code,
      retailer_type   = retailer_type_en,
      region          = region_en,
      region2,
      country         = country_en,
      city            = rtl_city,
      promotion_code,
      return          = return_count,
      quantity,
      unit_price,
      unit_sale_price,
      unit_cost,
      unit_prod_cost  = production_cost,
      unit_gross_marg = gross_margin,
      revenue,
      tot_prod_cost,
      gross_profit,
      prod_numb       = product_number,
      prod_line,
      prod_line_2,
      prod_type       = product_type,
      prod_name       = product_name,
      brand,
      color,
      size            = product_size,
      intro_date      = introduction_date,
      halt_date       = discontinued_date
   ) </code></pre>
<pre class="r"><code>orders_tbl %&gt;% glimpse()
## Observations: 446,023
## Variables: 36
## $ order_number     &lt;dbl&gt; 100001, 100001, 100002, 100002, 100002, 10000...
## $ order_date       &lt;dttm&gt; 2004-01-12, 2004-01-12, 2004-01-12, 2004-01-...
## $ order_close_date &lt;dttm&gt; 2004-02-17, 2004-02-17, 2004-01-19, 2004-01-...
## $ order_ship_date  &lt;dttm&gt; 2004-01-19, 2004-02-17, 2004-01-19, 2004-01-...
## $ fin_year         &lt;chr&gt; &quot;other&quot;, &quot;other&quot;, &quot;other&quot;, &quot;other&quot;, &quot;other&quot;, ...
## $ quarter_all      &lt;chr&gt; &quot;04_Q1&quot;, &quot;04_Q1&quot;, &quot;04_Q1&quot;, &quot;04_Q1&quot;, &quot;04_Q1&quot;, ...
## $ quarter_sel      &lt;chr&gt; &quot;other&quot;, &quot;other&quot;, &quot;other&quot;, &quot;other&quot;, &quot;other&quot;, ...
## $ order_method     &lt;chr&gt; &quot;Sales visit&quot;, &quot;Sales visit&quot;, &quot;Fax&quot;, &quot;Fax&quot;, &quot;...
## $ retailer         &lt;chr&gt; &quot;Kavanagh Sports&quot;, &quot;Kavanagh Sports&quot;, &quot;Ar fre...
## $ retailer_code    &lt;dbl&gt; 1398, 1398, 1760, 1760, 1760, 1760, 1760, 176...
## $ retailer_type    &lt;chr&gt; &quot;Sports Store&quot;, &quot;Sports Store&quot;, &quot;Outdoors Sho...
## $ region           &lt;chr&gt; &quot;Americas&quot;, &quot;Americas&quot;, &quot;Americas&quot;, &quot;Americas...
## $ region2          &lt;chr&gt; &quot;Americas&quot;, &quot;Americas&quot;, &quot;Americas&quot;, &quot;Americas...
## $ country          &lt;chr&gt; &quot;United States&quot;, &quot;United States&quot;, &quot;Brazil&quot;, &quot;...
## $ city             &lt;chr&gt; &quot;San Clara&quot;, &quot;San Clara&quot;, &quot;Sao Paulo&quot;, &quot;Sao P...
## $ promotion_code   &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...
## $ return           &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, ...
## $ quantity         &lt;dbl&gt; 256, 92, 162, 172, 74, 90, 422, 3252, 1107, 8...
## $ unit_price       &lt;dbl&gt; 35.09, 110.00, 119.69, 40.52, 359.60, 81.55, ...
## $ unit_sale_price  &lt;dbl&gt; 33.69, 102.30, 111.31, 38.90, 334.43, 75.84, ...
## $ unit_cost        &lt;dbl&gt; 15.62, 49.69, 80.00, 23.53, 176.47, 39.00, 2....
## $ unit_prod_cost   &lt;dbl&gt; 24.62, 73.33, 80.00, 23.53, 176.47, 39.00, 3....
## $ unit_gross_marg  &lt;dbl&gt; 0.23, 0.33, 0.28, 0.40, 0.40, 0.50, 0.50, 0.6...
## $ revenue          &lt;dbl&gt; 8983.04, 10120.00, 19389.78, 6969.44, 26610.4...
## $ tot_prod_cost    &lt;dbl&gt; 3998.72, 4571.48, 12960.00, 4047.16, 13058.78...
## $ gross_profit     &lt;dbl&gt; 4984.32, 5548.52, 6429.78, 2922.28, 13551.62,...
## $ prod_numb        &lt;dbl&gt; 41110, 69110, 75110, 76110, 85110, 65110, 100...
## $ prod_line        &lt;chr&gt; &quot;Camping Eqpt&quot;, &quot;Personal Acces&quot;, &quot;Personal A...
## $ prod_line_2      &lt;chr&gt; &quot;Camping Eqpt&quot;, &quot;Personal Acces&quot;, &quot;Personal A...
## $ prod_type        &lt;chr&gt; &quot;Lanterns&quot;, &quot;Eyewear&quot;, &quot;Knives&quot;, &quot;Knives&quot;, &quot;N...
## $ prod_name        &lt;chr&gt; &quot;Flicker Lantern&quot;, &quot;Polar Ice&quot;, &quot;Edge Extreme...
## $ brand            &lt;chr&gt; &quot;Firefly&quot;, &quot;Polar&quot;, &quot;Extreme&quot;, &quot;Edge&quot;, &quot;Extre...
## $ color            &lt;chr&gt; &quot;Orange&quot;, &quot;Black&quot;, &quot;Red&quot;, &quot;Black&quot;, &quot;Black&quot;, &quot;...
## $ size             &lt;chr&gt; &quot;8-hour&quot;, &quot;Men&#39;s&quot;, &quot;14.5 cm&quot;, &quot;33 cm&quot;, &quot;Unspe...
## $ intro_date       &lt;dttm&gt; 2005-01-10, 1995-02-15, 2000-10-26, 1995-02-...
## $ halt_date        &lt;dttm&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, ...</code></pre>
<p>Remove original files and save</p>
<p>Last but not least, I can drop all original files and save the <code>orders_tbl</code></p>
<pre class="r"><code># remove original files
rm(df, products, retailers, orders)

# Save orders as RDS
orders_tbl %&gt;%
   write_rds(&quot;orders_tbl.rds&quot;)</code></pre>
<p>Code Repository
The full R code can be found on <a href="https://github.com/DiegoUsaiUK/Loading_Merging_and_Joining_Datasets">my GitHub profile</a></p>
<p>NOTE: given their size, the RDS file and the order-details folder had to be compress before uploading them on my Github profile</p>
    
        </div>
    </section>

    <footer class="post-full-footer">
      <section class="author-card">
        <img class="author-profile-image" src="/img/Me_1.jpg" alt="Author" />
        <section class="author-card-content">
            <h4 class="author-card-name"><a href="/">Diego Usai</a></h4>
                <p></p>
        </section>
      </section>
    </footer>
</article>
    
    
    

  </div>
</main>


<aside class="read-next outer">
  <div class="inner">
    <div class="read-next-feed">      
      

      
      
      <article class="post-card post"> 
    
    <a class="post-card-image-link" href="/2019/09/modelling-with-tidymodels-and-parsnip/">
      <div class="post-card-image" style="background-image: url(/img/karim-ghantous-vIZGAYbOl30-unsplash.jpg)"></div>
    </a>
    

    <div class="post-card-content">
      <a class="post-card-content-link" href="/2019/09/modelling-with-tidymodels-and-parsnip/">
          <header class="post-card-header">
              <span class="post-card-tags">
              #Machine Learning 
              #Tidyverse 
              #Classification 
              #Churn 
              #API  </span>
              
              <h2 class="post-card-title">Modelling with Tidymodels and Parsnip - A Tidy Approach to a Classification Problem</h2>
          </header>
          <section class="post-card-excerpt">
              
                <p>Recently I have completed the online course Business Analysis With R focused on applied data and business science with R, which introduced me to a couple of new modelling concepts and approaches. One that especially captured my attention is parsnip and its attempt to implement a unified modelling and analysis interface (similar to python’s scikit-learn) to seamlessly access several modelling platforms in R.
parsnip is the brainchild of RStudio’s Max Khun (of caret fame) and Davis Vaughan and forms part of tidymodels, a growing ensemble of tools to explore and iterate modelling tasks that shares a common philosophy (and a few libraries) with the tidyverse. ...  </p>
              
          </section>
      </a>

      <footer class="post-card-meta">
          <img class="author-profile-image" src="/img/Me_1.jpg" alt="Author" />
          <span class="post-card-author"><a href="/">Diego Usai</a></span>
      </footer>
    </div>
</article>
      
    </div>
  </div>
</aside>

<div class="floating-header">
  <div class="floating-header-logo">
    <a href="/">
      
      <span></span>
    </a>
  </div>
  <span class="floating-header-divider">&mdash;</span>
  <div class="floating-header-title">Loading, Merging and Joining Datasets</div>
  <div class="floating-header-share">
    <div class="floating-header-share-label">Share this <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
     <path d="M7.5 15.5V4a1.5 1.5 0 1 1 3 0v4.5h2a1 1 0 0 1 1 1h2a1 1 0 0 1 1 1H18a1.5 1.5 0 0 1 1.5 1.5v3.099c0 .929-.13 1.854-.385 2.748L17.5 23.5h-9c-1.5-2-5.417-8.673-5.417-8.673a1.2 1.2 0 0 1 1.76-1.605L7.5 15.5zm6-6v2m-3-3.5v3.5m6-1v2"/></svg>
    </div>
    
    <a class="floating-header-share-tw" href="https://twitter.com/share?text=Loading%2c%20Merging%20and%20Joining%20Datasets&amp;url=%2f2019%2f09%2floading-merging-and-joining-datasets%2f"
          onclick="window.open(this.href, 'share-twitter', 'width=550,height=235');return false;">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M30.063 7.313c-.813 1.125-1.75 2.125-2.875 2.938v.75c0 1.563-.188 3.125-.688 4.625a15.088 15.088 0 0 1-2.063 4.438c-.875 1.438-2 2.688-3.25 3.813a15.015 15.015 0 0 1-4.625 2.563c-1.813.688-3.75 1-5.75 1-3.25 0-6.188-.875-8.875-2.625.438.063.875.125 1.375.125 2.688 0 5.063-.875 7.188-2.5-1.25 0-2.375-.375-3.375-1.125s-1.688-1.688-2.063-2.875c.438.063.813.125 1.125.125.5 0 1-.063 1.5-.25-1.313-.25-2.438-.938-3.313-1.938a5.673 5.673 0 0 1-1.313-3.688v-.063c.813.438 1.688.688 2.625.688a5.228 5.228 0 0 1-1.875-2c-.5-.875-.688-1.813-.688-2.75 0-1.063.25-2.063.75-2.938 1.438 1.75 3.188 3.188 5.25 4.25s4.313 1.688 6.688 1.813a5.579 5.579 0 0 1 1.5-5.438c1.125-1.125 2.5-1.688 4.125-1.688s3.063.625 4.188 1.813a11.48 11.48 0 0 0 3.688-1.375c-.438 1.375-1.313 2.438-2.563 3.188 1.125-.125 2.188-.438 3.313-.875z"/></svg>
      </a>
      <a class="floating-header-share-fb" href="https://www.facebook.com/sharer/sharer.php?u=%2f2019%2f09%2floading-merging-and-joining-datasets%2f"
          onclick="window.open(this.href, 'share-facebook','width=580,height=296');return false;">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M19 6h5V0h-5c-3.86 0-7 3.14-7 7v3H8v6h4v16h6V16h5l1-6h-6V7c0-.542.458-1 1-1z"/></svg>
      </a>
  </div>

  <progress class="progress" value="0">
    <div class="progress-container">
      <span class="progress-bar"></span>
    </div>
  </progress>
</div>



<footer class="site-footer outer">
  <div class="site-footer-content inner">
    <section class="copyright" style="line-height: 1.3em;">
      <a href="/">Diego Usai</a> © 2019 <br>
      <span style="font-size: 0.8em; color: #555;">Hugo port of <a href="https://github.com/TryGhost/Casper">Casper 2.1.7</a> by <a href="https://www.telematika.org">EM</a></span>
    </section>
    <nav class="site-footer-nav">
        <a href="/">Latest Posts</a>
        
        
        <a href="https://github.com/DiegoUsaiUK" target="_blank" rel="noopener">Github</a>
        <a href="https://www.linkedin.com/in/diegousaiuk" target="_blank" rel="noopener">LinkedIn</a>
        <a href="https://medium.com/@diegousaiuk" target="_blank" rel="noopener">Medium</a>
    </nav>  
  </div>
</footer>

</div>
<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
<script type="text/javascript" src="//code.jquery.com/jquery-3.2.1.min.js"></script>
<script type="text/javascript" src="/js/jquery.fitvids.js"></script>

<script>hljs.initHighlightingOnLoad();</script>



    <script>





$(document).ready(function () {
    
    var $postContent = $(".post-full-content");
    $postContent.fitVids();
    

    var progressBar = document.querySelector('progress');
    var header = document.querySelector('.floating-header');
    var title = document.querySelector('.post-full-title');

    var lastScrollY = window.scrollY;
    var lastWindowHeight = window.innerHeight;
    var lastDocumentHeight = $(document).height();
    var ticking = false;

    function onScroll() {
        lastScrollY = window.scrollY;
        requestTick();
    }

    function onResize() {
        lastWindowHeight = window.innerHeight;
        lastDocumentHeight = $(document).height();
        requestTick();
    }

    function requestTick() {
        if (!ticking) {
            requestAnimationFrame(update);
        }
        ticking = true;
    }

    function update() {
        var trigger = title.getBoundingClientRect().top + window.scrollY;
        var triggerOffset = title.offsetHeight + 35;
        var progressMax = lastDocumentHeight - lastWindowHeight;

        
        if (lastScrollY >= trigger + triggerOffset) {
            header.classList.add('floating-active');
        } else {
            header.classList.remove('floating-active');
        }

        progressBar.setAttribute('max', progressMax);
        progressBar.setAttribute('value', lastScrollY);

        ticking = false;
    }

    window.addEventListener('scroll', onScroll, {passive: true});
    window.addEventListener('resize', onResize, false);

    update();
});
</script>
</body></html>
